
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../Summarize-Benchmark/">
      
      
        <link rel="next" href="../NPAtlasAnalysis/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.11">
    
    
      
        <title>Metabolights analysis notebook - Learning ChEBI Classification Programs</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.4af4bdda.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../css/ansi-colours.css">
    
      <link rel="stylesheet" href="../../css/jupyter-cells.css">
    
      <link rel="stylesheet" href="../../css/pandas-dataframe.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="pink">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#metabolights-over-representation-analysis" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Learning ChEBI Classification Programs" class="md-header__button md-logo" aria-label="Learning ChEBI Classification Programs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Learning ChEBI Classification Programs
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Metabolights analysis notebook
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="pink"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="blue" data-md-color-accent="amber"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Learning ChEBI Classification Programs" class="md-nav__button md-logo" aria-label="Learning ChEBI Classification Programs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Learning ChEBI Classification Programs
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Methods
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Methods
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../leia/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Learning Algorithm
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../benchmark/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Benchmark
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chebacr/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Benchmark Evaluation
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Results
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Results
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../analysis/programs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Programs
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../analysis/performance/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Performance
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../analysis/code_analysis/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Code Analysis
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../analysis/chebifier/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Chebifier
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_5" >
        
          
          <label class="md-nav__link" for="__nav_3_5" id="__nav_3_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Applications
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_5">
            <span class="md-nav__icon md-icon"></span>
            Applications
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../analysis/npatlas/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Natural Products
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../analysis/metabolomics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Metabolomics
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_6" >
        
          
          <label class="md-nav__link" for="__nav_3_6" id="__nav_3_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Validation
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_6">
            <span class="md-nav__icon md-icon"></span>
            Validation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../analysis/curation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Curated
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../analysis/glycerophosphocholine/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Glycerophosphocholine
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_6_3" >
        
          
          <label class="md-nav__link" for="__nav_3_6_3" id="__nav_3_6_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Terpenoids
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_6_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_6_3">
            <span class="md-nav__icon md-icon"></span>
            Terpenoids
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../analysis/terpenoids/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    About
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../analysis/terpenoids_table.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Table
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_7" >
        
          
          <label class="md-nav__link" for="__nav_3_7" id="__nav_3_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Ranked Classes
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_7">
            <span class="md-nav__icon md-icon"></span>
            Ranked Classes
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../analysis/classes_top.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Top Classes
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../analysis/classes_bottom.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Bottom Classes
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../analysis/classes_all.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    All Classes
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Notebooks
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Notebooks
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Summarize-Benchmark/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Summarize Benchmark
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Metabolights analysis notebook
    
  </span>
  

      </a>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../NPAtlasAnalysis/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    NPAtlas analysis notebook
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Run-Chebifier/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Run Chebifier
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Analysis Code
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Analysis Code
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/datamodel/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Datamodel
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/learn/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Learn
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/classifier/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Classifier
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/extractor/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Extractor
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>
<script>
(function() {
  function addWidgetsRenderer() {
    var requireJsScript = document.createElement('script');
    requireJsScript.src = 'https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js';

    var mimeElement = document.querySelector('script[type="application/vnd.jupyter.widget-view+json"]');
    var jupyterWidgetsScript = document.createElement('script');
    var widgetRendererSrc = 'https://unpkg.com/@jupyter-widgets/html-manager@*/dist/embed-amd.js';
    var widgetState;

    // Fallback for older version:
    try {
      widgetState = mimeElement && JSON.parse(mimeElement.innerHTML);

      if (widgetState && (widgetState.version_major < 2 || !widgetState.version_major)) {
        widgetRendererSrc = 'jupyter-js-widgets@*/dist/embed.js';
      }
    } catch(e) {}

    jupyterWidgetsScript.src = widgetRendererSrc;

    document.body.appendChild(requireJsScript);
    document.body.appendChild(jupyterWidgetsScript);
  }

  document.addEventListener('DOMContentLoaded', addWidgetsRenderer);
}());
</script>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="metabolights-over-representation-analysis">Metabolights Over-representation Analysis</h1>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="highlight"><pre><span></span><code><span class="err">!</span><span class="n">pip</span> <span class="n">install</span> <span class="s2">&quot;linkml-store[mongodb]&quot;</span>
</code></pre></div>

</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_subarea output_stream output_stdout output_text">
<pre>
<code>Requirement already satisfied: linkml-store[mongodb] in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (0.2.9)
Requirement already satisfied: click in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from linkml-store[mongodb]) (8.1.8)
Requirement already satisfied: duckdb&gt;=0.10.1 in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from linkml-store[mongodb]) (1.2.2)
Requirement already satisfied: duckdb-engine&gt;=0.11.2 in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from linkml-store[mongodb]) (0.17.0)
Requirement already satisfied: jinja2&lt;4.0.0,&gt;=3.1.4 in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from linkml-store[mongodb]) (3.1.5)
Requirement already satisfied: jsonlines&lt;5.0.0,&gt;=4.0.0 in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from linkml-store[mongodb]) (4.0.0)
Requirement already satisfied: jsonpatch&gt;=1.33 in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from linkml-store[mongodb]) (1.33)
Requirement already satisfied: linkml-runtime&gt;=1.8.0 in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from linkml-store[mongodb]) (1.8.3)
Requirement already satisfied: multipledispatch in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from linkml-store[mongodb]) (1.0.0)
Requirement already satisfied: pydantic&lt;3.0.0,&gt;=2.0.0 in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from linkml-store[mongodb]) (2.10.4)
Collecting pymongo&lt;5.0,&gt;=4.11 (from linkml-store[mongodb])
  Downloading pymongo-4.12.0-cp311-cp311-macosx_11_0_arm64.whl.metadata (22 kB)
Requirement already satisfied: pystow&lt;0.6.0,&gt;=0.5.4 in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from linkml-store[mongodb]) (0.5.6)
Requirement already satisfied: python-dotenv&lt;2.0.0,&gt;=1.0.1 in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from linkml-store[mongodb]) (1.1.0)
Requirement already satisfied: sqlalchemy in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from linkml-store[mongodb]) (2.0.36)
Requirement already satisfied: tabulate in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from linkml-store[mongodb]) (0.9.0)
Requirement already satisfied: xmltodict&gt;=0.13.0 in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from linkml-store[mongodb]) (0.14.2)
Requirement already satisfied: packaging&gt;=21 in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from duckdb-engine&gt;=0.11.2-&gt;linkml-store[mongodb]) (24.2)
Requirement already satisfied: MarkupSafe&gt;=2.0 in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from jinja2&lt;4.0.0,&gt;=3.1.4-&gt;linkml-store[mongodb]) (3.0.2)
Requirement already satisfied: attrs&gt;=19.2.0 in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from jsonlines&lt;5.0.0,&gt;=4.0.0-&gt;linkml-store[mongodb]) (24.3.0)
Requirement already satisfied: jsonpointer&gt;=1.9 in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from jsonpatch&gt;=1.33-&gt;linkml-store[mongodb]) (3.0.0)
Requirement already satisfied: curies&gt;=0.5.4 in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from linkml-runtime&gt;=1.8.0-&gt;linkml-store[mongodb]) (0.10.1)
Requirement already satisfied: deprecated in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from linkml-runtime&gt;=1.8.0-&gt;linkml-store[mongodb]) (1.2.15)
Requirement already satisfied: hbreader in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from linkml-runtime&gt;=1.8.0-&gt;linkml-store[mongodb]) (0.9.1)
Requirement already satisfied: json-flattener&gt;=0.1.9 in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from linkml-runtime&gt;=1.8.0-&gt;linkml-store[mongodb]) (0.1.9)
Requirement already satisfied: jsonasobj2&lt;2.dev0,&gt;=1.0.4 in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from linkml-runtime&gt;=1.8.0-&gt;linkml-store[mongodb]) (1.0.4)
Requirement already satisfied: jsonschema&gt;=3.2.0 in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from linkml-runtime&gt;=1.8.0-&gt;linkml-store[mongodb]) (4.23.0)
Requirement already satisfied: prefixcommons&gt;=0.1.12 in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from linkml-runtime&gt;=1.8.0-&gt;linkml-store[mongodb]) (0.1.12)
Requirement already satisfied: prefixmaps&gt;=0.1.4 in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from linkml-runtime&gt;=1.8.0-&gt;linkml-store[mongodb]) (0.2.6)
Requirement already satisfied: pyyaml in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from linkml-runtime&gt;=1.8.0-&gt;linkml-store[mongodb]) (6.0.2)
Requirement already satisfied: rdflib&gt;=6.0.0 in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from linkml-runtime&gt;=1.8.0-&gt;linkml-store[mongodb]) (7.1.1)
Requirement already satisfied: requests in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from linkml-runtime&gt;=1.8.0-&gt;linkml-store[mongodb]) (2.32.3)
Requirement already satisfied: annotated-types&gt;=0.6.0 in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from pydantic&lt;3.0.0,&gt;=2.0.0-&gt;linkml-store[mongodb]) (0.7.0)
Requirement already satisfied: pydantic-core==2.27.2 in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from pydantic&lt;3.0.0,&gt;=2.0.0-&gt;linkml-store[mongodb]) (2.27.2)
Requirement already satisfied: typing-extensions&gt;=4.12.2 in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from pydantic&lt;3.0.0,&gt;=2.0.0-&gt;linkml-store[mongodb]) (4.12.2)
Collecting dnspython&lt;3.0.0,&gt;=1.16.0 (from pymongo&lt;5.0,&gt;=4.11-&gt;linkml-store[mongodb])
  Downloading dnspython-2.7.0-py3-none-any.whl.metadata (5.8 kB)
Requirement already satisfied: tqdm in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from pystow&lt;0.6.0,&gt;=0.5.4-&gt;linkml-store[mongodb]) (4.67.1)
Requirement already satisfied: pytrie in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from curies&gt;=0.5.4-&gt;linkml-runtime&gt;=1.8.0-&gt;linkml-store[mongodb]) (0.4.0)
Requirement already satisfied: jsonschema-specifications&gt;=2023.03.6 in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from jsonschema&gt;=3.2.0-&gt;linkml-runtime&gt;=1.8.0-&gt;linkml-store[mongodb]) (2024.10.1)
Requirement already satisfied: referencing&gt;=0.28.4 in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from jsonschema&gt;=3.2.0-&gt;linkml-runtime&gt;=1.8.0-&gt;linkml-store[mongodb]) (0.35.1)
Requirement already satisfied: rpds-py&gt;=0.7.1 in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from jsonschema&gt;=3.2.0-&gt;linkml-runtime&gt;=1.8.0-&gt;linkml-store[mongodb]) (0.22.3)
Requirement already satisfied: pytest-logging&lt;2016.0.0,&gt;=2015.11.4 in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from prefixcommons&gt;=0.1.12-&gt;linkml-runtime&gt;=1.8.0-&gt;linkml-store[mongodb]) (2015.11.4)
Requirement already satisfied: pyparsing&lt;4,&gt;=2.1.0 in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from rdflib&gt;=6.0.0-&gt;linkml-runtime&gt;=1.8.0-&gt;linkml-store[mongodb]) (3.2.1)
Requirement already satisfied: charset-normalizer&lt;4,&gt;=2 in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from requests-&gt;linkml-runtime&gt;=1.8.0-&gt;linkml-store[mongodb]) (3.4.1)
Requirement already satisfied: idna&lt;4,&gt;=2.5 in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from requests-&gt;linkml-runtime&gt;=1.8.0-&gt;linkml-store[mongodb]) (3.10)
Requirement already satisfied: urllib3&lt;3,&gt;=1.21.1 in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from requests-&gt;linkml-runtime&gt;=1.8.0-&gt;linkml-store[mongodb]) (2.3.0)
Requirement already satisfied: certifi&gt;=2017.4.17 in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from requests-&gt;linkml-runtime&gt;=1.8.0-&gt;linkml-store[mongodb]) (2024.12.14)
Requirement already satisfied: wrapt&lt;2,&gt;=1.10 in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from deprecated-&gt;linkml-runtime&gt;=1.8.0-&gt;linkml-store[mongodb]) (1.17.0)
Requirement already satisfied: pytest&gt;=2.8.1 in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from pytest-logging&lt;2016.0.0,&gt;=2015.11.4-&gt;prefixcommons&gt;=0.1.12-&gt;linkml-runtime&gt;=1.8.0-&gt;linkml-store[mongodb]) (8.3.4)
Requirement already satisfied: sortedcontainers in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from pytrie-&gt;curies&gt;=0.5.4-&gt;linkml-runtime&gt;=1.8.0-&gt;linkml-store[mongodb]) (2.4.0)
Requirement already satisfied: iniconfig in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from pytest&gt;=2.8.1-&gt;pytest-logging&lt;2016.0.0,&gt;=2015.11.4-&gt;prefixcommons&gt;=0.1.12-&gt;linkml-runtime&gt;=1.8.0-&gt;linkml-store[mongodb]) (2.0.0)
Requirement already satisfied: pluggy&lt;2,&gt;=1.5 in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from pytest&gt;=2.8.1-&gt;pytest-logging&lt;2016.0.0,&gt;=2015.11.4-&gt;prefixcommons&gt;=0.1.12-&gt;linkml-runtime&gt;=1.8.0-&gt;linkml-store[mongodb]) (1.5.0)
Downloading pymongo-4.12.0-cp311-cp311-macosx_11_0_arm64.whl (855 kB)
   <span class="ansi-black-intense-fg">━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━</span> <span class="ansi-green-fg">855.2/855.2 kB</span> <span class="ansi-red-fg">13.2 MB/s</span> eta <span class="ansi-cyan-fg">0:00:00</span>
Downloading dnspython-2.7.0-py3-none-any.whl (313 kB)
Installing collected packages: dnspython, pymongo
Successfully installed dnspython-2.7.0 pymongo-4.12.0
</code>
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">linkml_store.utils.enrichment_analyzer</span><span class="w"> </span><span class="kn">import</span> <span class="n">EnrichmentAnalyzer</span>

<span class="n">DB</span> <span class="o">=</span> <span class="s2">&quot;mongodb://localhost:27017/metabolights&quot;</span>
<span class="n">CN</span> <span class="o">=</span> <span class="s2">&quot;maf&quot;</span>
</code></pre></div>

</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="highlight"><pre><span></span><code><span class="err">!</span><span class="n">pip</span> <span class="n">install</span> <span class="n">oaklib</span>
</code></pre></div>

</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_subarea output_stream output_stdout output_text">
<pre>
<code>Requirement already satisfied: oaklib in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (0.6.18)
Requirement already satisfied: SPARQLWrapper in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from oaklib) (2.0.0)
Requirement already satisfied: SQLAlchemy&gt;=1.4.32 in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from oaklib) (2.0.36)
Requirement already satisfied: airium&gt;=0.2.5 in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from oaklib) (0.2.6)
Requirement already satisfied: appdirs&gt;=1.4.4 in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from oaklib) (1.4.4)
Requirement already satisfied: class-resolver&gt;=0.4.2 in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from oaklib) (0.5.4)
Requirement already satisfied: click in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from oaklib) (8.1.8)
Requirement already satisfied: curies&gt;=0.6.6 in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from oaklib) (0.10.1)
Requirement already satisfied: defusedxml&gt;=0.7.1 in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from oaklib) (0.7.1)
Requirement already satisfied: eutils&gt;=0.6.0 in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from oaklib) (0.6.0)
Requirement already satisfied: funowl&gt;=0.2.0 in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from oaklib) (0.2.3)
Requirement already satisfied: jsonlines in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from oaklib) (4.0.0)
Requirement already satisfied: kgcl-rdflib==0.5.0 in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from oaklib) (0.5.0)
Requirement already satisfied: kgcl-schema&lt;0.7.0,&gt;=0.6.9 in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from oaklib) (0.6.9)
Requirement already satisfied: linkml-renderer&gt;=0.3.0 in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from oaklib) (0.3.1)
Requirement already satisfied: linkml-runtime&gt;=1.5.3 in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from oaklib) (1.8.3)
Requirement already satisfied: ndex2&gt;=3.5.0 in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from oaklib) (3.9.0)
Requirement already satisfied: networkx&gt;=2.7.1 in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from oaklib) (3.2.1)
Requirement already satisfied: ols-client&gt;=0.1.1 in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from oaklib) (0.1.4)
Requirement already satisfied: ontoportal-client&gt;=0.0.3 in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from oaklib) (0.0.4)
Requirement already satisfied: prefixmaps&gt;=0.1.2 in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from oaklib) (0.2.6)
Requirement already satisfied: pronto&gt;=2.5.0 in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from oaklib) (2.5.8)
Requirement already satisfied: pydantic in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from oaklib) (2.10.4)
Requirement already satisfied: pysolr&lt;4.0.0,&gt;=3.9.0 in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from oaklib) (3.10.0)
Requirement already satisfied: pystow&gt;=0.5.0 in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from oaklib) (0.5.6)
Requirement already satisfied: ratelimit&gt;=2.2.1 in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from oaklib) (2.2.1)
Requirement already satisfied: requests-cache&lt;2.0.0,&gt;=1.0.1 in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from oaklib) (1.2.1)
Requirement already satisfied: semsql&gt;=0.3.1 in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from oaklib) (0.3.3)
Requirement already satisfied: sssom&lt;0.5.0,&gt;=0.4.4 in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from oaklib) (0.4.15)
Requirement already satisfied: tenacity&gt;=8.2.3 in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from oaklib) (9.0.0)
Requirement already satisfied: pytrie in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from curies&gt;=0.6.6-&gt;oaklib) (0.4.0)
Requirement already satisfied: typing-extensions in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from curies&gt;=0.6.6-&gt;oaklib) (4.12.2)
Requirement already satisfied: lxml in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from eutils&gt;=0.6.0-&gt;oaklib) (5.3.0)
Requirement already satisfied: pytz in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from eutils&gt;=0.6.0-&gt;oaklib) (2024.2)
Requirement already satisfied: requests in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from eutils&gt;=0.6.0-&gt;oaklib) (2.32.3)
Requirement already satisfied: bcp47 in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from funowl&gt;=0.2.0-&gt;oaklib) (0.1.0)
Requirement already satisfied: jsonasobj in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from funowl&gt;=0.2.0-&gt;oaklib) (1.3.1)
Requirement already satisfied: pyjsg&gt;=0.11.6 in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from funowl&gt;=0.2.0-&gt;oaklib) (0.11.10)
Requirement already satisfied: rdflib-shim in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from funowl&gt;=0.2.0-&gt;oaklib) (1.0.3)
Requirement already satisfied: rdflib&lt;8,&gt;=6.2.0 in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from funowl&gt;=0.2.0-&gt;oaklib) (7.1.1)
Requirement already satisfied: rfc3987 in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from funowl&gt;=0.2.0-&gt;oaklib) (1.3.8)
Requirement already satisfied: lark&gt;=1.1.2 in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from kgcl-schema&lt;0.7.0,&gt;=0.6.9-&gt;oaklib) (1.2.2)
Requirement already satisfied: deprecated in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from linkml-runtime&gt;=1.5.3-&gt;oaklib) (1.2.15)
Requirement already satisfied: hbreader in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from linkml-runtime&gt;=1.5.3-&gt;oaklib) (0.9.1)
Requirement already satisfied: json-flattener&gt;=0.1.9 in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from linkml-runtime&gt;=1.5.3-&gt;oaklib) (0.1.9)
Requirement already satisfied: jsonasobj2&lt;2.dev0,&gt;=1.0.4 in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from linkml-runtime&gt;=1.5.3-&gt;oaklib) (1.0.4)
Requirement already satisfied: jsonschema&gt;=3.2.0 in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from linkml-runtime&gt;=1.5.3-&gt;oaklib) (4.23.0)
Requirement already satisfied: prefixcommons&gt;=0.1.12 in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from linkml-runtime&gt;=1.5.3-&gt;oaklib) (0.1.12)
Requirement already satisfied: pyyaml in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from linkml-runtime&gt;=1.5.3-&gt;oaklib) (6.0.2)
Requirement already satisfied: six in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from ndex2&gt;=3.5.0-&gt;oaklib) (1.17.0)
Requirement already satisfied: ijson in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from ndex2&gt;=3.5.0-&gt;oaklib) (3.3.0)
Requirement already satisfied: requests-toolbelt in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from ndex2&gt;=3.5.0-&gt;oaklib) (1.0.0)
Requirement already satisfied: urllib3&gt;=1.16 in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from ndex2&gt;=3.5.0-&gt;oaklib) (2.3.0)
Requirement already satisfied: pandas in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from ndex2&gt;=3.5.0-&gt;oaklib) (2.2.3)
Requirement already satisfied: numpy in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from ndex2&gt;=3.5.0-&gt;oaklib) (2.0.2)
Requirement already satisfied: more-click in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from ols-client&gt;=0.1.1-&gt;oaklib) (0.1.2)
Requirement already satisfied: chardet~=5.0 in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from pronto&gt;=2.5.0-&gt;oaklib) (5.2.0)
Requirement already satisfied: fastobo~=0.12.2 in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from pronto&gt;=2.5.0-&gt;oaklib) (0.12.3)
Requirement already satisfied: python-dateutil~=2.8 in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from pronto&gt;=2.5.0-&gt;oaklib) (2.9.0.post0)
Requirement already satisfied: annotated-types&gt;=0.6.0 in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from pydantic-&gt;oaklib) (0.7.0)
Requirement already satisfied: pydantic-core==2.27.2 in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from pydantic-&gt;oaklib) (2.27.2)
Requirement already satisfied: setuptools in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from pysolr&lt;4.0.0,&gt;=3.9.0-&gt;oaklib) (75.6.0)
Requirement already satisfied: tqdm in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from pystow&gt;=0.5.0-&gt;oaklib) (4.67.1)
Requirement already satisfied: attrs&gt;=21.2 in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from requests-cache&lt;2.0.0,&gt;=1.0.1-&gt;oaklib) (24.3.0)
Requirement already satisfied: cattrs&gt;=22.2 in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from requests-cache&lt;2.0.0,&gt;=1.0.1-&gt;oaklib) (24.1.2)
Requirement already satisfied: platformdirs&gt;=2.5 in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from requests-cache&lt;2.0.0,&gt;=1.0.1-&gt;oaklib) (4.3.6)
Requirement already satisfied: url-normalize&gt;=1.4 in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from requests-cache&lt;2.0.0,&gt;=1.0.1-&gt;oaklib) (1.4.3)
Requirement already satisfied: SQLAlchemy-Utils&lt;0.39.0,&gt;=0.38.2 in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from semsql&gt;=0.3.1-&gt;oaklib) (0.38.3)
Requirement already satisfied: deprecation&lt;3.0.0,&gt;=2.1.0 in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from sssom&lt;0.5.0,&gt;=0.4.4-&gt;oaklib) (2.1.0)
Requirement already satisfied: importlib-resources&lt;7.0.0,&gt;=6.1.1 in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from sssom&lt;0.5.0,&gt;=0.4.4-&gt;oaklib) (6.5.2)
Requirement already satisfied: linkml&gt;1.7.10 in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from sssom&lt;0.5.0,&gt;=0.4.4-&gt;oaklib) (1.8.5)
Requirement already satisfied: pansql&gt;=0.0.1 in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from pansql[pansql]&gt;=0.0.1-&gt;sssom&lt;0.5.0,&gt;=0.4.4-&gt;oaklib) (0.0.1)
Requirement already satisfied: scipy[scipy] in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from sssom&lt;0.5.0,&gt;=0.4.4-&gt;oaklib) (1.13.1)
Requirement already satisfied: sssom-schema&lt;2.0.0,&gt;=1.0.0 in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from sssom&lt;0.5.0,&gt;=0.4.4-&gt;oaklib) (1.0.0)
Requirement already satisfied: validators&gt;=0.20.0 in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from sssom&lt;0.5.0,&gt;=0.4.4-&gt;oaklib) (0.34.0)
Requirement already satisfied: packaging in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from deprecation&lt;3.0.0,&gt;=2.1.0-&gt;sssom&lt;0.5.0,&gt;=0.4.4-&gt;oaklib) (24.2)
Requirement already satisfied: jsonschema-specifications&gt;=2023.03.6 in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from jsonschema&gt;=3.2.0-&gt;linkml-runtime&gt;=1.5.3-&gt;oaklib) (2024.10.1)
Requirement already satisfied: referencing&gt;=0.28.4 in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from jsonschema&gt;=3.2.0-&gt;linkml-runtime&gt;=1.5.3-&gt;oaklib) (0.35.1)
Requirement already satisfied: rpds-py&gt;=0.7.1 in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from jsonschema&gt;=3.2.0-&gt;linkml-runtime&gt;=1.5.3-&gt;oaklib) (0.22.3)
Requirement already satisfied: antlr4-python3-runtime&lt;4.10,&gt;=4.9.0 in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from linkml&gt;1.7.10-&gt;sssom&lt;0.5.0,&gt;=0.4.4-&gt;oaklib) (4.9.3)
Requirement already satisfied: graphviz&gt;=0.10.1 in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from linkml&gt;1.7.10-&gt;sssom&lt;0.5.0,&gt;=0.4.4-&gt;oaklib) (0.20.3)
Requirement already satisfied: isodate&gt;=0.6.0 in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from linkml&gt;1.7.10-&gt;sssom&lt;0.5.0,&gt;=0.4.4-&gt;oaklib) (0.7.2)
Requirement already satisfied: jinja2&gt;=3.1.0 in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from linkml&gt;1.7.10-&gt;sssom&lt;0.5.0,&gt;=0.4.4-&gt;oaklib) (3.1.5)
Requirement already satisfied: linkml-dataops in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from linkml&gt;1.7.10-&gt;sssom&lt;0.5.0,&gt;=0.4.4-&gt;oaklib) (0.1.0)
Requirement already satisfied: openpyxl in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from linkml&gt;1.7.10-&gt;sssom&lt;0.5.0,&gt;=0.4.4-&gt;oaklib) (3.1.5)
Requirement already satisfied: parse in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from linkml&gt;1.7.10-&gt;sssom&lt;0.5.0,&gt;=0.4.4-&gt;oaklib) (1.20.2)
Requirement already satisfied: pyshex&gt;=0.7.20 in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from linkml&gt;1.7.10-&gt;sssom&lt;0.5.0,&gt;=0.4.4-&gt;oaklib) (0.8.1)
Requirement already satisfied: pyshexc&gt;=0.8.3 in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from linkml&gt;1.7.10-&gt;sssom&lt;0.5.0,&gt;=0.4.4-&gt;oaklib) (0.9.1)
Requirement already satisfied: watchdog&gt;=0.9.0 in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from linkml&gt;1.7.10-&gt;sssom&lt;0.5.0,&gt;=0.4.4-&gt;oaklib) (6.0.0)
<span class="ansi-yellow-fg">WARNING: networkx 3.2.1 does not provide the extra 'networkx'</span><span class="ansi-yellow-fg">
</span>Requirement already satisfied: tzdata&gt;=2022.7 in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from pandas-&gt;ndex2&gt;=3.5.0-&gt;oaklib) (2024.2)
<span class="ansi-yellow-fg">WARNING: pansql 0.0.1 does not provide the extra 'pansql'</span><span class="ansi-yellow-fg">
</span>Requirement already satisfied: pytest-logging&lt;2016.0.0,&gt;=2015.11.4 in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from prefixcommons&gt;=0.1.12-&gt;linkml-runtime&gt;=1.5.3-&gt;oaklib) (2015.11.4)
Requirement already satisfied: pyparsing&lt;4,&gt;=2.1.0 in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from rdflib&lt;8,&gt;=6.2.0-&gt;funowl&gt;=0.2.0-&gt;oaklib) (3.2.1)
Requirement already satisfied: charset-normalizer&lt;4,&gt;=2 in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from requests-&gt;eutils&gt;=0.6.0-&gt;oaklib) (3.4.1)
Requirement already satisfied: idna&lt;4,&gt;=2.5 in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from requests-&gt;eutils&gt;=0.6.0-&gt;oaklib) (3.10)
Requirement already satisfied: certifi&gt;=2017.4.17 in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from requests-&gt;eutils&gt;=0.6.0-&gt;oaklib) (2024.12.14)
Requirement already satisfied: wrapt&lt;2,&gt;=1.10 in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from deprecated-&gt;linkml-runtime&gt;=1.5.3-&gt;oaklib) (1.17.0)
Requirement already satisfied: sortedcontainers in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from pytrie-&gt;curies&gt;=0.6.6-&gt;oaklib) (2.4.0)
Requirement already satisfied: rdflib-jsonld==0.6.1 in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from rdflib-shim-&gt;funowl&gt;=0.2.0-&gt;oaklib) (0.6.1)
<span class="ansi-yellow-fg">WARNING: scipy 1.13.1 does not provide the extra 'scipy'</span><span class="ansi-yellow-fg">
</span>Requirement already satisfied: MarkupSafe&gt;=2.0 in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from jinja2&gt;=3.1.0-&gt;linkml&gt;1.7.10-&gt;sssom&lt;0.5.0,&gt;=0.4.4-&gt;oaklib) (3.0.2)
Requirement already satisfied: fqdn in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from jsonschema[format]&gt;=4.0.0-&gt;linkml&gt;1.7.10-&gt;sssom&lt;0.5.0,&gt;=0.4.4-&gt;oaklib) (1.5.1)
Requirement already satisfied: isoduration in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from jsonschema[format]&gt;=4.0.0-&gt;linkml&gt;1.7.10-&gt;sssom&lt;0.5.0,&gt;=0.4.4-&gt;oaklib) (20.11.0)
Requirement already satisfied: jsonpointer&gt;1.13 in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from jsonschema[format]&gt;=4.0.0-&gt;linkml&gt;1.7.10-&gt;sssom&lt;0.5.0,&gt;=0.4.4-&gt;oaklib) (3.0.0)
Requirement already satisfied: rfc3339-validator in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from jsonschema[format]&gt;=4.0.0-&gt;linkml&gt;1.7.10-&gt;sssom&lt;0.5.0,&gt;=0.4.4-&gt;oaklib) (0.1.4)
Requirement already satisfied: uri-template in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from jsonschema[format]&gt;=4.0.0-&gt;linkml&gt;1.7.10-&gt;sssom&lt;0.5.0,&gt;=0.4.4-&gt;oaklib) (1.3.0)
Requirement already satisfied: webcolors&gt;=1.11 in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from jsonschema[format]&gt;=4.0.0-&gt;linkml&gt;1.7.10-&gt;sssom&lt;0.5.0,&gt;=0.4.4-&gt;oaklib) (24.11.1)
Requirement already satisfied: cfgraph&gt;=0.2.1 in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from pyshex&gt;=0.7.20-&gt;linkml&gt;1.7.10-&gt;sssom&lt;0.5.0,&gt;=0.4.4-&gt;oaklib) (0.2.1)
Requirement already satisfied: shexjsg&gt;=0.8.2 in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from pyshex&gt;=0.7.20-&gt;linkml&gt;1.7.10-&gt;sssom&lt;0.5.0,&gt;=0.4.4-&gt;oaklib) (0.8.2)
Requirement already satisfied: sparqlslurper&gt;=0.5.1 in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from pyshex&gt;=0.7.20-&gt;linkml&gt;1.7.10-&gt;sssom&lt;0.5.0,&gt;=0.4.4-&gt;oaklib) (0.5.1)
Requirement already satisfied: pytest&gt;=2.8.1 in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from pytest-logging&lt;2016.0.0,&gt;=2015.11.4-&gt;prefixcommons&gt;=0.1.12-&gt;linkml-runtime&gt;=1.5.3-&gt;oaklib) (8.3.4)
Requirement already satisfied: jsonpatch in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from linkml-dataops-&gt;linkml&gt;1.7.10-&gt;sssom&lt;0.5.0,&gt;=0.4.4-&gt;oaklib) (1.33)
Requirement already satisfied: jsonpath-ng in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from linkml-dataops-&gt;linkml&gt;1.7.10-&gt;sssom&lt;0.5.0,&gt;=0.4.4-&gt;oaklib) (1.7.0)
Requirement already satisfied: ruamel.yaml in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from linkml-dataops-&gt;linkml&gt;1.7.10-&gt;sssom&lt;0.5.0,&gt;=0.4.4-&gt;oaklib) (0.18.8)
Requirement already satisfied: et-xmlfile in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from openpyxl-&gt;linkml&gt;1.7.10-&gt;sssom&lt;0.5.0,&gt;=0.4.4-&gt;oaklib) (2.0.0)
Requirement already satisfied: iniconfig in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from pytest&gt;=2.8.1-&gt;pytest-logging&lt;2016.0.0,&gt;=2015.11.4-&gt;prefixcommons&gt;=0.1.12-&gt;linkml-runtime&gt;=1.5.3-&gt;oaklib) (2.0.0)
Requirement already satisfied: pluggy&lt;2,&gt;=1.5 in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from pytest&gt;=2.8.1-&gt;pytest-logging&lt;2016.0.0,&gt;=2015.11.4-&gt;prefixcommons&gt;=0.1.12-&gt;linkml-runtime&gt;=1.5.3-&gt;oaklib) (1.5.0)
Requirement already satisfied: arrow&gt;=0.15.0 in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from isoduration-&gt;jsonschema[format]&gt;=4.0.0-&gt;linkml&gt;1.7.10-&gt;sssom&lt;0.5.0,&gt;=0.4.4-&gt;oaklib) (1.3.0)
Requirement already satisfied: ply in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from jsonpath-ng-&gt;linkml-dataops-&gt;linkml&gt;1.7.10-&gt;sssom&lt;0.5.0,&gt;=0.4.4-&gt;oaklib) (3.11)
Requirement already satisfied: ruamel.yaml.clib&gt;=0.2.7 in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from ruamel.yaml-&gt;linkml-dataops-&gt;linkml&gt;1.7.10-&gt;sssom&lt;0.5.0,&gt;=0.4.4-&gt;oaklib) (0.2.12)
Requirement already satisfied: types-python-dateutil&gt;=2.8.10 in /Users/cjm/Library/Caches/pypoetry/virtualenvs/c3p-93U7KWO_-py3.11/lib/python3.11/site-packages (from arrow&gt;=0.15.0-&gt;isoduration-&gt;jsonschema[format]&gt;=4.0.0-&gt;linkml&gt;1.7.10-&gt;sssom&lt;0.5.0,&gt;=0.4.4-&gt;oaklib) (2.9.0.20241206)
</code>
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">oaklib</span><span class="w"> </span><span class="kn">import</span> <span class="n">get_adapter</span>
<span class="n">chebi_adapter</span> <span class="o">=</span> <span class="n">get_adapter</span><span class="p">(</span><span class="s2">&quot;sqlite:obo:chebi&quot;</span><span class="p">)</span>
</code></pre></div>

</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">linkml_store</span><span class="w"> </span><span class="kn">import</span> <span class="n">Client</span>

<span class="n">client</span> <span class="o">=</span> <span class="n">Client</span><span class="p">()</span>
<span class="n">db</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">attach_database</span><span class="p">(</span><span class="n">DB</span><span class="p">)</span>
<span class="n">collection</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">get_collection</span><span class="p">(</span><span class="n">CN</span><span class="p">)</span>
<span class="n">study_collection</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">get_collection</span><span class="p">(</span><span class="s2">&quot;study&quot;</span><span class="p">)</span>
</code></pre></div>

</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_info</span><span class="p">(</span><span class="n">study</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
    <span class="n">inv</span> <span class="o">=</span> <span class="n">study</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;isaInvestigation&quot;</span><span class="p">,</span> <span class="p">{})</span>
    <span class="n">studies</span> <span class="o">=</span> <span class="n">inv</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;studies&quot;</span><span class="p">,</span> <span class="p">[])</span>
    <span class="n">s0</span> <span class="o">=</span> <span class="n">studies</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="n">studies</span> <span class="k">else</span> <span class="p">{}</span>
    <span class="n">title</span> <span class="o">=</span> <span class="n">s0</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;title&quot;</span><span class="p">)</span>
    <span class="n">desc</span> <span class="o">=</span> <span class="n">s0</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;description&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">title</span> <span class="ow">and</span> <span class="n">title</span> <span class="o">!=</span> <span class="s2">&quot;Investigation&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">title</span><span class="p">,</span> <span class="n">desc</span>
    <span class="n">title</span> <span class="o">=</span> <span class="n">inv</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;title&quot;</span><span class="p">)</span>
    <span class="n">desc</span> <span class="o">=</span> <span class="n">inv</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;description&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">title</span><span class="p">,</span> <span class="n">desc</span>
</code></pre></div>

</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="highlight"><pre><span></span><code><span class="n">study</span> <span class="o">=</span> <span class="n">study_collection</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">limit</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">rows</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">get_info</span><span class="p">(</span><span class="n">study</span><span class="p">))</span>
</code></pre></div>

</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_subarea output_stream output_stdout output_text">
<pre>
<code>('A metabolomic study of urinary changes in type 2 diabetes in human compared to the control group', 'Type 2 diabetes mellitus is the result of a combination of impaired insulin secretion with reduced insulin sensitivity of target tissues. There are an estimated 150 million affected individuals worldwide, of whom a large proportion remains undiagnosed because of a lack of specific symptoms early in this disorder and inadequate diagnostics. In this study, NMR-based metabolomic analysis in conjunction with uni- and multivariate statistics was applied to examine the urinary metabolic changes in Human type 2 diabetes mellitus patients compared to the control group. The human population were un medicated diabetic patients who have good daily dietary control over their blood glucose concentrations by following the guidelines on diet issued by the American Diabetes Association. Note: This is part of a larger study, please refer to the original paper below.')
</code>
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">study_id_from_path</span><span class="p">(</span><span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
    <span class="k">if</span> <span class="s2">&quot;/&quot;</span> <span class="ow">in</span> <span class="n">path</span><span class="p">:</span>
        <span class="c1"># e.g. foo/bar/MTBLS1/FILE.json</span>
        <span class="k">return</span> <span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">path</span>


<span class="k">def</span><span class="w"> </span><span class="nf">study_by_id</span><span class="p">(</span><span class="n">study_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
    <span class="k">if</span> <span class="s2">&quot;/&quot;</span> <span class="ow">in</span> <span class="n">study_id</span><span class="p">:</span>
        <span class="n">study_id</span> <span class="o">=</span> <span class="n">study_id_from_path</span><span class="p">(</span><span class="n">study_id</span><span class="p">)</span>
    <span class="c1"># isaInvestigation.identifier</span>
    <span class="n">rows</span> <span class="o">=</span> <span class="n">study_collection</span><span class="o">.</span><span class="n">find</span><span class="p">({</span><span class="s2">&quot;isaInvestigation.identifier&quot;</span><span class="p">:</span> <span class="n">study_id</span><span class="p">})</span><span class="o">.</span><span class="n">rows</span>
    <span class="k">if</span> <span class="n">rows</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">rows</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">return</span> <span class="kc">None</span>

<span class="n">get_info</span><span class="p">(</span><span class="n">study_by_id</span><span class="p">(</span><span class="s2">&quot;MTBLS1&quot;</span><span class="p">))</span>
</code></pre></div>

</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_text output_subarea output_execute_result">
<pre>
<code>('A metabolomic study of urinary changes in type 2 diabetes in human compared to the control group',
 'Type 2 diabetes mellitus is the result of a combination of impaired insulin secretion with reduced insulin sensitivity of target tissues. There are an estimated 150 million affected individuals worldwide, of whom a large proportion remains undiagnosed because of a lack of specific symptoms early in this disorder and inadequate diagnostics. In this study, NMR-based metabolomic analysis in conjunction with uni- and multivariate statistics was applied to examine the urinary metabolic changes in Human type 2 diabetes mellitus patients compared to the control group. The human population were un medicated diabetic patients who have good daily dietary control over their blood glucose concentrations by following the guidelines on diet issued by the American Diabetes Association. Note: This is part of a larger study, please refer to the original paper below.')</code>
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">info_by_id</span><span class="p">(</span><span class="n">study_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
    <span class="n">study</span> <span class="o">=</span> <span class="n">study_by_id</span><span class="p">(</span><span class="n">study_id</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">study</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">get_info</span><span class="p">(</span><span class="n">study</span><span class="p">)</span>
</code></pre></div>

</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="highlight"><pre><span></span><code><span class="n">info_by_id</span><span class="p">(</span><span class="s2">&quot;MTBLS138&quot;</span><span class="p">)</span>
</code></pre></div>

</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_text output_subarea output_execute_result">
<pre>
<code>('Multi-omics phenotyping of the gut-liver axis reveals metabolic perturbations from a low-dose pesticide mixture in rats',
 'Health effects of pesticides are not always accurately detected using the current battery of regulatory toxicity tests. We compared standard histopathology and serum biochemistry measures and multi-omics analyses in a subchronic toxicity test of a mixture of six pesticides frequently detected in foodstuffs (azoxystrobin, boscalid, chlorpyrifos, glyphosate, imidacloprid and thiabendazole) in Sprague-Dawley rats. Analysis of water and feed consumption, body weight, histopathology and serum biochemistry showed little effect. Contrastingly, serum and caecum metabolomics revealed that nicotinamide and tryptophan metabolism were affected, which suggested activation of an oxidative stress response. This was not reflected by gut microbial community composition changes evaluated by shotgun metagenomics. Transcriptomics of the liver showed that 257 genes had their expression changed. Gene functions affected included the regulation of response to steroid hormones and the activation of stress response pathways. Genome-wide DNA methylation analysis of the same liver samples showed that 4,255 CpG sites were differentially methylated. Overall, we demonstrated that in-depth molecular profiling in laboratory animals exposed to low concentrations of pesticides allows the detection of metabolic perturbations that would remain undetected by standard regulatory biochemical measures and which could thus improve the predictability of health risks from exposure to chemical pollutants.')</code>
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="highlight"><pre><span></span><code><span class="n">ea</span> <span class="o">=</span> <span class="n">EnrichmentAnalyzer</span><span class="o">.</span><span class="n">from_collection</span><span class="p">(</span><span class="n">collection</span><span class="p">,</span> <span class="n">sample_key</span><span class="o">=</span><span class="s2">&quot;src&quot;</span><span class="p">,</span> 
                                        <span class="n">classification_key</span><span class="o">=</span><span class="s2">&quot;c3p_classifications&quot;</span><span class="p">)</span>
</code></pre></div>

</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="highlight"><pre><span></span><code><span class="n">sample_ids</span> <span class="o">=</span> <span class="n">ea</span><span class="o">.</span><span class="n">sample_ids</span>
</code></pre></div>

</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="highlight"><pre><span></span><code><span class="n">results</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># for df</span>
<span class="n">cases</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># for llm-matrix</span>
<span class="k">for</span> <span class="n">sample</span> <span class="ow">in</span> <span class="n">sample_ids</span><span class="p">:</span>
    <span class="n">study_id</span> <span class="o">=</span> <span class="n">study_id_from_path</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>
    <span class="n">study_title</span><span class="p">,</span> <span class="n">desc</span> <span class="o">=</span> <span class="n">info_by_id</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">study_title</span><span class="p">:</span>
        <span class="k">continue</span>
    <span class="n">file_name</span> <span class="o">=</span> <span class="n">sample</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="c1"># print(f&quot;## {study_title}&quot;)</span>
    <span class="n">ideals</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">ers</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">ea</span><span class="o">.</span><span class="n">find_enriched_categories</span><span class="p">(</span><span class="n">sample</span><span class="p">,</span> <span class="n">p_value_threshold</span><span class="o">=</span><span class="mf">0.05</span><span class="p">):</span>
        <span class="c1">#print(f&quot;## {study_title} -- {sample}&quot;)</span>
        <span class="c1">#print(f&quot;      DESC: {desc}&quot;)</span>
        <span class="c1">#print(f&quot; *  {chebi_adapter.label(r.category)} :: {r}&quot;)</span>
        <span class="n">category_label</span> <span class="o">=</span> <span class="n">chebi_adapter</span><span class="o">.</span><span class="n">label</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">category</span><span class="p">)</span>
        <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
            <span class="s2">&quot;study_id&quot;</span><span class="p">:</span> <span class="n">study_id</span><span class="p">,</span>
            <span class="s2">&quot;study&quot;</span><span class="p">:</span> <span class="n">study_title</span><span class="p">,</span>
            <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="n">desc</span><span class="p">,</span>
            <span class="s2">&quot;sample_file&quot;</span><span class="p">:</span> <span class="n">file_name</span><span class="p">,</span>
            <span class="s2">&quot;category_label&quot;</span><span class="p">:</span> <span class="n">category_label</span><span class="p">,</span>
            <span class="o">**</span><span class="n">r</span><span class="o">.</span><span class="n">model_dump</span><span class="p">(),</span>
        <span class="p">})</span>
        <span class="n">ers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">model_dump</span><span class="p">())</span>
        <span class="n">ideals</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">r</span><span class="o">.</span><span class="n">adjusted_p_value</span><span class="p">,</span> <span class="n">category_label</span><span class="p">))</span>
    <span class="c1"># sort by p-value</span>
    <span class="n">ideals</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">ideals</span><span class="p">:</span>
        <span class="n">enrichment_summary</span> <span class="o">=</span> <span class="s2">&quot;; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">. </span><span class="si">{</span><span class="n">label</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">label</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">ideals</span><span class="p">)])</span>
        <span class="n">cases</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
            <span class="s2">&quot;input&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Title: </span><span class="si">{</span><span class="n">study_title</span><span class="si">}</span><span class="se">\n</span><span class="s2">Description: </span><span class="si">{</span><span class="n">desc</span><span class="si">}</span><span class="se">\n</span><span class="s2">Enriched: </span><span class="si">{</span><span class="n">enrichment_summary</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="s2">&quot;original_input&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;study_id&quot;</span><span class="p">:</span> <span class="n">study_id</span><span class="p">,</span>
                <span class="s2">&quot;study&quot;</span><span class="p">:</span> <span class="n">study_title</span><span class="p">,</span>
                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="n">desc</span><span class="p">,</span>
                <span class="s2">&quot;sample_file&quot;</span><span class="p">:</span> <span class="n">file_name</span><span class="p">,</span>
                <span class="s2">&quot;enrichment&quot;</span><span class="p">:</span> <span class="n">ers</span><span class="p">,</span>
            <span class="p">},</span>
            <span class="s2">&quot;ideal&quot;</span><span class="p">:</span> <span class="s2">&quot;YES&quot;</span><span class="p">,</span>
        <span class="p">})</span>
</code></pre></div>

</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="highlight"><pre><span></span><code><span class="n">suite</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;metabolights_c3po_enrichment&quot;</span><span class="p">,</span>
    <span class="s2">&quot;template&quot;</span><span class="p">:</span> <span class="s2">&quot;enrichment&quot;</span><span class="p">,</span>
    <span class="s2">&quot;templates&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;enrichment&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;system&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;&quot;I will give you a metabolomics study title and description,</span>
<span class="s2">            and also the ordered list of chemical classes that are enriched for that study.</span>
<span class="s2">            Tell me if the enrichment results make sense.</span>
<span class="s2">            Return YES, NO, or OTHER, followed by an explanation.</span>
<span class="s2">            The explanation can be of any form and length but your response must start with YES, NO, or OTHER.</span>
<span class="s2">            &quot;&quot;&quot;</span><span class="p">,</span>
            <span class="s2">&quot;prompt&quot;</span><span class="p">:</span> <span class="s1">&#39;</span><span class="si">{input}</span><span class="s1">&#39;</span><span class="p">,</span>
            <span class="s2">&quot;metrics&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;qa_with_explanation&quot;</span><span class="p">],</span>
        <span class="p">},</span>
    <span class="p">},</span>
    <span class="s2">&quot;matrix&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;hyperparameters&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;model&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;claude-sonnet&quot;</span><span class="p">]</span>
        <span class="p">},</span>
    <span class="p">},</span>
    <span class="s2">&quot;cases&quot;</span><span class="p">:</span> <span class="n">cases</span><span class="p">,</span>
<span class="p">}</span>
</code></pre></div>

</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">yaml</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;metabolights-ora-results/metabolights_enrichment_suite.yaml&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">yaml</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">suite</span><span class="p">,</span> <span class="n">sort_keys</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
</code></pre></div>

</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="highlight"><pre><span></span><code> <span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>
</code></pre></div>

</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="highlight"><pre><span></span><code><span class="n">df</span>
</code></pre></div>

</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>study_id</th>
<th>study</th>
<th>description</th>
<th>sample_file</th>
<th>category_label</th>
<th>category</th>
<th>fold_change</th>
<th>original_p_value</th>
<th>adjusted_p_value</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>MTBLS10416</td>
<td>A metabolic switch orchestrated by IL-18 and t...</td>
<td>Tissues are exposed to diverse inflammatory ch...</td>
<td>m_MTBLS10416_LC-MS_alternating_hilic_metabolit...</td>
<td>fatty acid anion</td>
<td>CHEBI:28868</td>
<td>46481.178571</td>
<td>2.724382e-14</td>
<td>2.179505e-13</td>
</tr>
<tr>
<th>1</th>
<td>MTBLS10416</td>
<td>A metabolic switch orchestrated by IL-18 and t...</td>
<td>Tissues are exposed to diverse inflammatory ch...</td>
<td>m_MTBLS10416_LC-MS_alternating_hilic_metabolit...</td>
<td>monocarboxylic acid anion</td>
<td>CHEBI:35757</td>
<td>22832.859649</td>
<td>3.331356e-09</td>
<td>1.332542e-08</td>
</tr>
<tr>
<th>2</th>
<td>MTBLS10416</td>
<td>A metabolic switch orchestrated by IL-18 and t...</td>
<td>Tissues are exposed to diverse inflammatory ch...</td>
<td>m_MTBLS10416_LC-MS_alternating_hilic_metabolit...</td>
<td>tricarboxylic acid</td>
<td>CHEBI:27093</td>
<td>1191.825092</td>
<td>8.387285e-04</td>
<td>2.236609e-03</td>
</tr>
<tr>
<th>3</th>
<td>MTBLS10416</td>
<td>A metabolic switch orchestrated by IL-18 and t...</td>
<td>Tissues are exposed to diverse inflammatory ch...</td>
<td>m_MTBLS10416_LC-MS_alternating_hilic_metabolit...</td>
<td>fatty alcohol</td>
<td>CHEBI:24026</td>
<td>584.668913</td>
<td>1.709033e-03</td>
<td>2.962744e-03</td>
</tr>
<tr>
<th>4</th>
<td>MTBLS10416</td>
<td>A metabolic switch orchestrated by IL-18 and t...</td>
<td>Tissues are exposed to diverse inflammatory ch...</td>
<td>m_MTBLS10416_LC-MS_alternating_hilic_metabolit...</td>
<td>cation</td>
<td>CHEBI:36916</td>
<td>539.582504</td>
<td>1.851715e-03</td>
<td>2.962744e-03</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>1336</th>
<td>MTBLS959</td>
<td>Subcellular antibiotic visualization reveals a...</td>
<td>Tuberculosis, caused by the intracellular path...</td>
<td>m_MTBLS959_LC-MS_alternating_reverse-phase_met...</td>
<td>diterpenoid</td>
<td>CHEBI:23849</td>
<td>9.885406</td>
<td>1.783922e-02</td>
<td>1.783922e-02</td>
</tr>
<tr>
<th>1337</th>
<td>MTBLS968</td>
<td>The accumulation profiles of terpene metabolit...</td>
<td>Aroma is an important parameter for table grap...</td>
<td>m_MTBLS968_GC-MS_positive__metabolite_profilin...</td>
<td>fatty alcohol</td>
<td>CHEBI:24026</td>
<td>4823.518531</td>
<td>1.853589e-39</td>
<td>7.414355e-39</td>
</tr>
<tr>
<th>1338</th>
<td>MTBLS968</td>
<td>The accumulation profiles of terpene metabolit...</td>
<td>Aroma is an important parameter for table grap...</td>
<td>m_MTBLS968_GC-MS_positive__metabolite_profilin...</td>
<td>prenols</td>
<td>CHEBI:26244</td>
<td>32536.825000</td>
<td>1.593974e-09</td>
<td>3.187947e-09</td>
</tr>
<tr>
<th>1339</th>
<td>MTBLS968</td>
<td>The accumulation profiles of terpene metabolit...</td>
<td>Aroma is an important parameter for table grap...</td>
<td>m_MTBLS968_GC-MS_positive__metabolite_profilin...</td>
<td>fatty aldehyde</td>
<td>CHEBI:35746</td>
<td>7935.810976</td>
<td>2.904251e-08</td>
<td>3.872335e-08</td>
</tr>
<tr>
<th>1340</th>
<td>MTBLS968</td>
<td>The accumulation profiles of terpene metabolit...</td>
<td>Aroma is an important parameter for table grap...</td>
<td>m_MTBLS968_GC-MS_positive__metabolite_profilin...</td>
<td>fatty acid</td>
<td>CHEBI:35366</td>
<td>102.188521</td>
<td>9.741102e-03</td>
<td>9.741102e-03</td>
</tr>
</tbody>
</table>
<p>1341 rows × 9 columns</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="highlight"><pre><span></span><code><span class="err">!</span><span class="n">mkdir</span> <span class="o">-</span><span class="n">p</span> <span class="n">output</span>
</code></pre></div>

</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="highlight"><pre><span></span><code><span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">&quot;output/enrichment_results.csv&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div>

</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="highlight"><pre><span></span><code>
</code></pre></div>

</div>
</div>












                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["content.tabs.link"], "search": "../../assets/javascripts/workers/search.f8cc74c7.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.c8b220af.min.js"></script>
      
    
  </body>
</html>