"""
Classifies: CHEBI:35342 17alpha-hydroxy steroid
"""
"""
Classifies: CHEBI:28817 17alpha-hydroxy steroid
"""
from rdkit import Chem

def is_17alpha_hydroxy_steroid(smiles: str):
    """
    Determines if a molecule is a 17alpha-hydroxy steroid based on its SMILES string.
    A 17alpha-hydroxy steroid has a steroid backbone with a hydroxyl group at the 17th position in the alpha configuration.

    Args:
        smiles (str): SMILES string of the molecule

    Returns:
        bool: True if molecule is a 17alpha-hydroxy steroid, False otherwise
        str: Reason for classification
    """
    
    # Parse SMILES
    mol = Chem.MolFromSmiles(smiles)
    if mol is None:
        return False, "Invalid SMILES string"

    # Define the steroid backbone pattern (four fused rings)
    steroid_backbone = Chem.MolFromSmarts("[*]1~[*]~[*]~[*]~[*]~[*]1.[*]1~[*]~[*]~[*]~[*]~[*]1.[*]1~[*]~[*]~[*]~[*]~[*]1.[*]1~[*]~[*]~[*]~[*]1")
    if not mol.HasSubstructMatch(steroid_backbone):
        return False, "No steroid backbone found"

    # Define the 17alpha-hydroxy pattern (hydroxyl group at the 17th position in alpha configuration)
    alpha_hydroxy_pattern = Chem.MolFromSmarts("[C@H](O)[C@@]1([H])CC[C@]2([H])[C@@]3([H])CC[C@]4([H])[C@@]5([H])CC[C@]6([H])[C@@]7([H])CC[C@]8([H])[C@@]9([H])CC[C@]10([H])[C@@]11([H])CC[C@]12([H])[C@@]13([H])CC[C@]14([H])[C@@]15([H])CC[C@]16([H])[C@@]17([H])CC[C@]18([H])[C@@]19([H])CC[C@]20([H])[C@@]21([H])CC[C@]22([H])[C@@]23([H])CC[C@]24([H])[C@@]25([H])CC[C@]26([H])[C@@]27([H])CC[C@]28([H])[C@@]29([H])CC[C@]30([H])[C@@]31([H])CC[C@]32([H])[C@@]33([H])CC[C@]34([H])[C@@]35([H])CC[C@]36([H])[C@@]37([H])CC[C@]38([H])[C@@]39([H])CC[C@]40([H])[C@@]41([H])CC[C@]42([H])[C@@]43([H])CC[C@]44([H])[C@@]45([H])CC[C@]46([H])[C@@]47([H])CC[C@]48([H])[C@@]49([H])CC[C@]50([H])[C@@]51([H])CC[C@]52([H])[C@@]53([H])CC[C@]54([H])[C@@]55([H])CC[C@]56([H])[C@@]57([H])CC[C@]58([H])[C@@]59([H])CC[C@]60([H])[C@@]61([H])CC[C@]62([H])[C@@]63([H])CC[C@]64([H])[C@@]65([H])CC[C@]66([H])[C@@]67([H])CC[C@]68([H])[C@@]69([H])CC[C@]70([H])[C@@]71([H])CC[C@]72([H])[C@@]73([H])CC[C@]74([H])[C@@]75([H])CC[C@]76([H])[C@@]77([H])CC[C@]78([H])[C@@]79([H])CC[C@]80([H])[C@@]81([H])CC[C@]82([H])[C@@]83([H])CC[C@]84([H])[C@@]85([H])CC[C@]86([H])[C@@]87([H])CC[C@]88([H])[C@@]89([H])CC[C@]90([H])[C@@]91([H])CC[C@]92([H])[C@@]93([H])CC[C@]94([H])[C@@]95([H])CC[C@]96([H])[C@@]97([H])CC[C@]98([H])[C@@]99([H])CC[C@]100([H])[C@@]101([H])CC[C@]102([H])[C@@]103([H])CC[C@]104([H])[C@@]105([H])CC[C@]106([H])[C@@]107([H])CC[C@]108([H])[C@@]109([H])CC[C@]110([H])[C@@]111([H])CC[C@]112([H])[C@@]113([H])CC[C@]114([H])[C@@]115([H])CC[C@]116([H])[C@@]117([H])CC[C@]118([H])[C@@]119([H])CC[C@]120([H])[C@@]121([H])CC[C@]122([H])[C@@]123([H])CC[C@]124([H])[C@@]125([H])CC[C@]126([H])[C@@]127([H])CC[C@]128([H])[C@@]129([H])CC[C@]130([H])[C@@]131([H])CC[C@]132([H])[C@@]133([H])CC[C@]134([H])[C@@]135([H])CC[C@]136([H])[C@@]137([H])CC[C@]138([H])[C@@]139([H])CC[C@]140([H])[C@@]141([H])CC[C@]142([H])[C@@]143([H])CC[C@]144([H])[C@@]145([H])CC[C@]146([H])[C@@]147([H])CC[C@]148([H])[C@@]149([H])CC[C@]150([H])[C@@]151([H])CC[C@]152([H])[C@@]153([H])CC[C@]154([H])[C@@]155([H])CC[C@]156([H])[C@@]157([H])CC[C@]158([H])[C@@]159([H])CC[C@]160([H])[C@@]161([H])CC[C@]162([H])[C@@]163([H])CC[C@]164([H])[C@@]165([H])CC[C@]166([H])[C@@]167([H])CC[C@]168([H])[C@@]169([H])CC[C@]170([H])[C@@]171([H])CC[C@]172([H])[C@@]173([H])CC[C@]174([H])[C@@]175([H])CC[C@]176([H])[C@@]177([H])CC[C@]178([H])[C@@]179([H])CC[C@]180([H])[C@@]181([H])CC[C@]182([H])[C@@]183([H])CC[C@]184([H])[C@@]185([H])CC[C@]186([H])[C@@]187([H])CC[C@]188([H])[C@@]189([H])CC[C@]190([H])[C@@]191([H])CC[C@]192([H])[C@@]193([H])CC[C@]194([H])[C@@]195([H])CC[C@]196([H])[C@@]197([H])CC[C@]198([H])[C@@]199([H])CC[C@]200([H])[C@@]201([H])CC[C@]202([H])[C@@]203([H])CC[C@]204([H])[C@@]205([H])CC[C@]206([H])[C@@]207([H])CC[C@]208([H])[C@@]209([H])CC[C@]210([H])[C@@]211([H])CC[C@]212([H])[C@@]213([H])CC[C@]214([H])[C@@]215([H])CC[C@]216([H])[C@@]217([H])CC[C@]218([H])[C@@]219([H])CC[C@]220([H])[C@@]221([H])CC[C@]222([H])[C@@]223([H])CC[C@]224([H])[C@@]225([H])CC[C@]226([H])[C@@]227([H])CC[C@]228([H])[C@@]229([H])CC[C@]230([H])[C@@]231([H])CC[C@]232([H])[C@@]233([H])CC[C@]234([H])[C@@]235([H])CC[C@]236([H])[C@@]237([H])CC[C@]238([H])[C@@]239([H])CC[C@]240([H])[C@@]241([H])CC[C@]242([H])[C@@]243([H])CC[C@]244([H])[C@@]245([H])CC[C@]246([H])[C@@]247([H])CC[C@]248([H])[C@@]249([H])CC[C@]250([H])[C@@]251([H])CC[C@]252([H])[C@@]253([H])CC[C@]254([H])[C@@]255([H])CC[C@]256([H])[C@@]257([H])CC[C@]258([H])[C@@]259([H])CC[C@]260([H])[C@@]261([H])CC[C@]262([H])[C@@]263([H])CC[C@]264([H])[C@@]265([H])CC[C@]266([H])[C@@]267([H])CC[C@]268([H])[C@@]269([H])CC[C@]270([H])[C@@]271([H])CC[C@]272([H])[C@@]273([H])CC[C@]274([H])[C@@]275([H])CC[C@]276([H])[C@@]277([H])CC[C@]278([H])[C@@]279([H])CC[C@]280([H])[C@@]281([H])CC[C@]282([H])[C@@]283([H])CC[C@]284([H])[C@@]285([H])CC[C@]286([H])[C@@]287([H])CC[C@]288([H])[C@@]289([H])CC[C@]290([H])[C@@]291([H])CC[C@]292([H])[C@@]293([H])CC[C@]294([H])[C@@]295([H])CC[C@]296([H])[C@@]297([H])CC[C@]298([H])[C@@]299([H])CC[C@]300([H])[C@@]301([H])CC[C@]302([H])[C@@]303([H])CC[C@]304([H])[C@@]305([H])CC[C@]306([H])[C@@]307([H])CC[C@]308([H])[C@@]309([H])CC[C@]310([H])[C@@]311([H])CC[C@]312([H])[C@@]313([H])CC[C@]314([H])[C@@]315([H])CC[C@]316([H])[C@@]317([H])CC[C@]318([H])[C@@]319([H])CC[C@]320([H])[C@@]321([H])CC[C@]322([H])[C@@]323([H])CC[C@]324([H])[C@@]325([H])CC[C@]326([H])[C@@]327([H])CC[C@]328([H])[C@@]329([H])CC[C@]330([H])[C@@]331([H])CC[C@]332([H])[C@@]333([H])CC[C@]334([H])[C@@]335([H])CC[C@]336([H])[C@@]337([H])CC[C@]338([H])[C@@]339([H])CC[C@]340([H])[C@@]341([H])CC[C@]342([H])[C@@]343([H])CC[C@]344([H])[C@@]345([H])CC[C@]346([H])[C@@]347([H])CC[C@]348([H])[C@@]349([H])CC[C@]350([H])[C@@]351([H])CC[C@]352([H])[C@@]353([H])CC[C@]354([H])[C@@]355([H])CC[C@]356([H])[C@@]357([H])CC[C@]358([H])[C@@]359([H])CC[C@]360([H])[C@@]361([H])CC[C@]362([H])[C@@]363([H])CC[C@]364([H])[C@@]365([H])CC[C@]366([H])[C@@]367([H])CC[C@]368([H])[C@@]369([H])CC[C@]370([H])[C@@]371([H])CC[C@]372([H])[C@@]373([H])CC[C@]374([H])[C@@]375([H])CC[C@]376([H])[C@@]377([H])CC[C@]378([H])[C@@]379([H])CC[C@]380([H])[C@@]381([H])CC[C@]382([H])[C@@]383([H])CC[C@]384([H])[C@@]385([H])CC[C@]386([H])[C@@]387([H])CC[C@]388([H])[C@@]389([H])CC[C@]390([H])[C@@]391([H])CC[C@]392([H])[C@@]393([H])CC[C@]394([H])[C@@]395([H])CC[C@]396([H])[C@@]397([H])CC[C@]398([H])[C@@]399([H])CC[C@]400([H])[C@@]401([H])CC[C@]402([H])[C@@]403([H])CC[C@]404([H])[C@@]405([H])CC[C@]406([H])[C@@]407([H])CC[C@]408([H])[C@@]409([H])CC[C@]410([H])[C@@]411([H])CC[C@]412([H])[C@@]413([H])CC[C@]414([H])[C@@]415([H])CC[C@]416([H])[C@@]417([H])CC[C@]418([H])[C@@]419([H])CC[C@]420([H])[C@@]421([H])CC[C@]422([H])[C@@]423([H])CC[C@]424([H])[C@@]425([H])CC[C@]426([H])[C@@]427([H])CC[C@]428([H])[C@@]429([H])CC[C@]430([H])[C@@]431([H])CC[C@]432([H])[C@@]433([H])CC[C@]434([H])[C@@]435([H])CC[C@]436([H])[C@@]437([H])CC[C@]438([H])[C@@]439([H])CC[C@]440([H])[C@@]441([H])CC[C@]442([H])[C@@]443([H])CC[C@]444([H])[C@@]445([H])CC[C@]446([H])[C@@]447([H])CC[C@]448([H])[C@@]449([H])CC[C@]450([H])[C@@]451([H])CC[C@]452([H])[C@@]453([H])CC[C@]454([H])[C@@]455([H])CC[C@]456([