"""
Classifies: CHEBI:1722 3beta-hydroxy-Delta(5)-steroid
"""
"""
Classifies: CHEBI:28852 3beta-hydroxy-Delta(5)-steroid
"""
from rdkit import Chem
from rdkit.Chem import AllChem

def is_3beta_hydroxy_Delta_5__steroid(smiles: str):
    """
    Determines if a molecule is a 3beta-hydroxy-Delta(5)-steroid based on its SMILES string.
    A 3beta-hydroxy-Delta(5)-steroid has a steroid backbone with a hydroxyl group at the 3rd position
    in the beta configuration and a double bond between positions 5 and 6.

    Args:
        smiles (str): SMILES string of the molecule

    Returns:
        bool: True if molecule is a 3beta-hydroxy-Delta(5)-steroid, False otherwise
        str: Reason for classification
    """
    
    # Parse SMILES
    mol = Chem.MolFromSmiles(smiles)
    if mol is None:
        return False, "Invalid SMILES string"

    # Check for steroid backbone (four fused rings: three 6-membered and one 5-membered)
    steroid_pattern = Chem.MolFromSmarts("[C@H]1[C@@H]2[C@H](O)[C@H]3[C@H](C[C@H]4[C@H](C[C@H]5[C@H](C[C@H]6[C@H](C[C@H]7[C@H](C[C@H]8[C@H](C[C@H]9[C@H](C[C@H]%10[C@H](C[C@H]%11[C@H](C[C@H]%12[C@H](C[C@H]%13[C@H](C[C@H]%14[C@H](C[C@H]%15[C@H](C[C@H]%16[C@H](C[C@H]%17[C@H](C[C@H]%18[C@H](C[C@H]%19[C@H](C[C@H]%20[C@H](C[C@H]%21[C@H](C[C@H]%22[C@H](C[C@H]%23[C@H](C[C@H]%24[C@H](C[C@H]%25[C@H](C[C@H]%26[C@H](C[C@H]%27[C@H](C[C@H]%28[C@H](C[C@H]%29[C@H](C[C@H]%30[C@H](C[C@H]%31[C@H](C[C@H]%32[C@H](C[C@H]%33[C@H](C[C@H]%34[C@H](C[C@H]%35[C@H](C[C@H]%36[C@H](C[C@H]%37[C@H](C[C@H]%38[C@H](C[C@H]%39[C@H](C[C@H]%40[C@H](C[C@H]%41[C@H](C[C@H]%42[C@H](C[C@H]%43[C@H](C[C@H]%44[C@H](C[C@H]%45[C@H](C[C@H]%46[C@H](C[C@H]%47[C@H](C[C@H]%48[C@H](C[C@H]%49[C@H](C[C@H]%50[C@H](C[C@H]%51[C@H](C[C@H]%52[C@H](C[C@H]%53[C@H](C[C@H]%54[C@H](C[C@H]%55[C@H](C[C@H]%56[C@H](C[C@H]%57[C@H](C[C@H]%58[C@H](C[C@H]%59[C@H](C[C@H]%60[C@H](C[C@H]%61[C@H](C[C@H]%62[C@H](C[C@H]%63[C@H](C[C@H]%64[C@H](C[C@H]%65[C@H](C[C@H]%66[C@H](C[C@H]%67[C@H](C[C@H]%68[C@H](C[C@H]%69[C@H](C[C@H]%70[C@H](C[C@H]%71[C@H](C[C@H]%72[C@H](C[C@H]%73[C@H](C[C@H]%74[C@H](C[C@H]%75[C@H](C[C@H]%76[C@H](C[C@H]%77[C@H](C[C@H]%78[C@H](C[C@H]%79[C@H](C[C@H]%80[C@H](C[C@H]%81[C@H](C[C@H]%82[C@H](C[C@H]%83[C@H](C[C@H]%84[C@H](C[C@H]%85[C@H](C[C@H]%86[C@H](C[C@H]%87[C@H](C[C@H]%88[C@H](C[C@H]%89[C@H](C[C@H]%90[C@H](C[C@H]%91[C@H](C[C@H]%92[C@H](C[C@H]%93[C@H](C[C@H]%94[C@H](C[C@H]%95[C@H](C[C@H]%96[C@H](C[C@H]%97[C@H](C[C@H]%98[C@H](C[C@H]%99[C@H](C[C@H]%100[C@H](C[C@H]%101[C@H](C[C@H]%102[C@H](C[C@H]%103[C@H](C[C@H]%104[C@H](C[C@H]%105[C@H](C[C@H]%106[C@H](C[C@H]%107[C@H](C[C@H]%108[C@H](C[C@H]%109[C@H](C[C@H]%110[C@H](C[C@H]%111[C@H](C[C@H]%112[C@H](C[C@H]%113[C@H](C[C@H]%114[C@H](C[C@H]%115[C@H](C[C@H]%116[C@H](C[C@H]%117[C@H](C[C@H]%118[C@H](C[C@H]%119[C@H](C[C@H]%120[C@H](C[C@H]%121[C@H](C[C@H]%122[C@H](C[C@H]%123[C@H](C[C@H]%124[C@H](C[C@H]%125[C@H](C[C@H]%126[C@H](C[C@H]%127[C@H](C[C@H]%128[C@H](C[C@H]%129[C@H](C[C@H]%130[C@H](C[C@H]%131[C@H](C[C@H]%132[C@H](C[C@H]%133[C@H](C[C@H]%134[C@H](C[C@H]%135[C@H](C[C@H]%136[C@H](C[C@H]%137[C@H](C[C@H]%138[C@H](C[C@H]%139[C@H](C[C@H]%140[C@H](C[C@H]%141[C@H](C[C@H]%142[C@H](C[C@H]%143[C@H](C[C@H]%144[C@H](C[C@H]%145[C@H](C[C@H]%146[C@H](C[C@H]%147[C@H](C[C@H]%148[C@H](C[C@H]%149[C@H](C[C@H]%150[C@H](C[C@H]%151[C@H](C[C@H]%152[C@H](C[C@H]%153[C@H](C[C@H]%154[C@H](C[C@H]%155[C@H](C[C@H]%156[C@H](C[C@H]%157[C@H](C[C@H]%158[C@H](C[C@H]%159[C@H](C[C@H]%160[C@H](C[C@H]%161[C@H](C[C@H]%162[C@H](C[C@H]%163[C@H](C[C@H]%164[C@H](C[C@H]%165[C@H](C[C@H]%166[C@H](C[C@H]%167[C@H](C[C@H]%168[C@H](C[C@H]%169[C@H](C[C@H]%170[C@H](C[C@H]%171[C@H](C[C@H]%172[C@H](C[C@H]%173[C@H](C[C@H]%174[C@H](C[C@H]%175[C@H](C[C@H]%176[C@H](C[C@H]%177[C@H](C[C@H]%178[C@H](C[C@H]%179[C@H](C[C@H]%180[C@H](C[C@H]%181[C@H](C[C@H]%182[C@H](C[C@H]%183[C@H](C[C@H]%184[C@H](C[C@H]%185[C@H](C[C@H]%186[C@H](C[C@H]%187[C@H](C[C@H]%188[C@H](C[C@H]%189[C@H](C[C@H]%190[C@H](C[C@H]%191[C@H](C[C@H]%192[C@H](C[C@H]%193[C@H](C[C@H]%194[C@H](C[C@H]%195[C@H](C[C@H]%196[C@H](C[C@H]%197[C@H](C[C@H]%198[C@H](C[C@H]%199[C@H](C[C@H]%200[C@H](C[C@H]%201[C@H](C[C@H]%202[C@H](C[C@H]%203[C@H](C[C@H]%204[C@H](C[C@H]%205[C@H](C[C@H]%206[C@H](C[C@H]%207[C@H](C[C@H]%208[C@H](C[C@H]%209[C@H](C[C@H]%210[C@H](C[C@H]%211[C@H](C[C@H]%212[C@H](C[C@H]%213[C@H](C[C@H]%214[C@H](C[C@H]%215[C@H](C[C@H]%216[C@H](C[C@H]%217[C@H](C[C@H]%218[C@H](C[C@H]%219[C@H](C[C@H]%220[C@H](C[C@H]%221[C@H](C[C@H]%222[C@H](C[C@H]%223[C@H](C[C@H]%224[C@H](C[C@H]%225[C@H](C[C@H]%226[C@H](C[C@H]%227[C@H](C[C@H]%228[C@H](C[C@H]%229[C@H](C[C@H]%230[C@H](C[C@H]%231[C@H](C[C@H]%232[C@H](C[C@H]%233[C@H](C[C@H]%234[C@H](C[C@H]%235[C@H](C[C@H]%236[C@H](C[C@H]%237[C@H](C[C@H]%238[C@H](C[C@H]%239[C@H](C[C@H]%240[C@H](C[C@H]%241[C@H](C[C@H]%242[C@H](C[C@H]%243[C@H](C[C@H]%244[C@H](C[C@H]%245[C@H](C[C@H]%246[C@H](C[C@H]%247[C@H](C[C@H]%248[C@H](C[C@H]%249[C@H](C[C@H]%250[C@H](C[C@H]%251[C@H](C[C@H]%252[C@H](C[C@H]%253[C@H](C[C@H]%254[C@H](C[C@H]%255[C@H](C[C@H]%256[C@H](C[C@H]%257[C@H](C[C@H]%258[C@H](C[C@H]%259[C@H](C[C@H]%260[C@H](C[C@H]%261[C@H](C[C@H]%262[C@H](C[C@H]%263[C@H](C[C@H]%264[C@H](C[C@H]%265[C@H](C[C@H]%266[C@H](C[C@H]%267[C@H](C[C@H]%268[C@H](C[C@H]%269[C@H](C[C@H]%270[C@H](C[C@H]%271[C@H](C[C@H]%272[C@H](C[C@H]%273[C@H](C[C@H]%274[C@H](C[C@H]%275[C@H](C[C@H]%276[C@H](C[C@H]%277[C@H](C[C@H]%278[C@H](C[C@H]%279[C@H](C[C@H]%280[C@H](C[C@H]%281[C@H](C[C@H]%282[C@H](C[C@H]%283[C@H](C[C@H]%284[C@H](C[C@H]%285[C@H](C[C@H]%286[C@H](C[C@H]%287[C@H](C[C@H]%288[C@H](C[C@H]%289[C@H](C[C@H]%290[C@H](C[C@H]%291[C@H](C[C@H]%292[C@H](C[C@H]%293[C@H](C[C@H]%294[C@H](C[C@H]%295[C@H](C[C@H]%296[C@H](C[C@H]%297[C@H](C[C@H]%298[C@H](C[C@H]%299[C@H](C[C@H]%300[C@H](C[C@H]%301[C@H](C[C@H]%302[C@H](C[C@H]%303[C@H](C[C@H]%304[C@H](C[C@H]%305[C@H](C[C@H]%306[C@H](C[C@H]%307[C@H](C[C@H]%308[C@H](C[C@H]%309[C@H](C[C@H]%310[C@H](C[C@H]%311[C@H](C[C@H]%312[C@H](C[C@H]%313[C@H](C[C@H]%314[C@H](C[C@H]%315[C@H](C[C@H]%316[C@H](C[C@H]%317[C@H](C[C@H]%318[C@H](C[C@H]%319[C@H](C[C@H]%320[C@H](C[C@H]%321[C@H](C[C@H]%322[C@H](C[C@H]%323[C@H](C[C@H]%324[C@H](C[C@H]%325[C@H](C[C@H]%326[C@H](C[C@H]%327[C@H](C[C@H]%328[C@H](C[C@H]%329[C@H](C[C@H]%330[C@H](C[C@H]%331[C@H](C[C@H]%332[C@H](C[C@H]%333[C@H](C[C@H]%334[C@H](C[C@H]%335[C@H](C[C@H]%336[C@H](C[C@H]%337[C@H](C[C@H]%338[C@H](C[C@H