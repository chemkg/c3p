"""
Classifies: CHEBI:26214 porphyrins
"""
"""
Classifies: CHEBI:26218 porphyrin
"""
from rdkit import Chem
from rdkit.Chem import rdMolDescriptors

def is_porphyrins(smiles: str):
    """
    Determines if a molecule is a porphyrin based on its SMILES string.
    A porphyrin is a macrocyclic structure with four pyrrole rings connected by methine bridges.

    Args:
        smiles (str): SMILES string of the molecule

    Returns:
        bool: True if molecule is a porphyrin, False otherwise
        str: Reason for classification
    """
    
    # Parse SMILES
    mol = Chem.MolFromSmiles(smiles)
    if mol is None:
        return False, "Invalid SMILES string"

    # Look for the core porphyrin structure
    # More flexible pattern: 4 pyrrole-like rings connected by methine bridges
    porphyrin_pattern = Chem.MolFromSmarts("[nH]1cccc1-c2cccc3-c4cccc([nH]4)-c5cccc([nH]5)-c6cccc([nH]6)-c7cccc([nH]7)-c8cccc([nH]8)-c9cccc([nH]9)-c%10cccc([nH]%10)-c%11cccc([nH]%11)-c%12cccc([nH]%12)-c%13cccc([nH]%13)-c%14cccc([nH]%14)-c%15cccc([nH]%15)-c%16cccc([nH]%16)-c%17cccc([nH]%17)-c%18cccc([nH]%18)-c%19cccc([nH]%19)-c%20cccc([nH]%20)-c%21cccc([nH]%21)-c%22cccc([nH]%22)-c%23cccc([nH]%23)-c%24cccc([nH]%24)-c%25cccc([nH]%25)-c%26cccc([nH]%26)-c%27cccc([nH]%27)-c%28cccc([nH]%28)-c%29cccc([nH]%29)-c%30cccc([nH]%30)-c%31cccc([nH]%31)-c%32cccc([nH]%32)-c%33cccc([nH]%33)-c%34cccc([nH]%34)-c%35cccc([nH]%35)-c%36cccc([nH]%36)-c%37cccc([nH]%37)-c%38cccc([nH]%38)-c%39cccc([nH]%39)-c%40cccc([nH]%40)-c%41cccc([nH]%41)-c%42cccc([nH]%42)-c%43cccc([nH]%43)-c%44cccc([nH]%44)-c%45cccc([nH]%45)-c%46cccc([nH]%46)-c%47cccc([nH]%47)-c%48cccc([nH]%48)-c%49cccc([nH]%49)-c%50cccc([nH]%50)-c%51cccc([nH]%51)-c%52cccc([nH]%52)-c%53cccc([nH]%53)-c%54cccc([nH]%54)-c%55cccc([nH]%55)-c%56cccc([nH]%56)-c%57cccc([nH]%57)-c%58cccc([nH]%58)-c%59cccc([nH]%59)-c%60cccc([nH]%60)-c%61cccc([nH]%61)-c%62cccc([nH]%62)-c%63cccc([nH]%63)-c%64cccc([nH]%64)-c%65cccc([nH]%65)-c%66cccc([nH]%66)-c%67cccc([nH]%67)-c%68cccc([nH]%68)-c%69cccc([nH]%69)-c%70cccc([nH]%70)-c%71cccc([nH]%71)-c%72cccc([nH]%72)-c%73cccc([nH]%73)-c%74cccc([nH]%74)-c%75cccc([nH]%75)-c%76cccc([nH]%76)-c%77cccc([nH]%77)-c%78cccc([nH]%78)-c%79cccc([nH]%79)-c%80cccc([nH]%80)-c%81cccc([nH]%81)-c%82cccc([nH]%82)-c%83cccc([nH]%83)-c%84cccc([nH]%84)-c%85cccc([nH]%85)-c%86cccc([nH]%86)-c%87cccc([nH]%87)-c%88cccc([nH]%88)-c%89cccc([nH]%89)-c%90cccc([nH]%90)-c%91cccc([nH]%91)-c%92cccc([nH]%92)-c%93cccc([nH]%93)-c%94cccc([nH]%94)-c%95cccc([nH]%95)-c%96cccc([nH]%96)-c%97cccc([nH]%97)-c%98cccc([nH]%98)-c%99cccc([nH]%99)-c%100cccc([nH]%100)-c%101cccc([nH]%101)-c%102cccc([nH]%102)-c%103cccc([nH]%103)-c%104cccc([nH]%104)-c%105cccc([nH]%105)-c%106cccc([nH]%106)-c%107cccc([nH]%107)-c%108cccc([nH]%108)-c%109cccc([nH]%109)-c%110cccc([nH]%110)-c%111cccc([nH]%111)-c%112cccc([nH]%112)-c%113cccc([nH]%113)-c%114cccc([nH]%114)-c%115cccc([nH]%115)-c%116cccc([nH]%116)-c%117cccc([nH]%117)-c%118cccc([nH]%118)-c%119cccc([nH]%119)-c%120cccc([nH]%120)-c%121cccc([nH]%121)-c%122cccc([nH]%122)-c%123cccc([nH]%123)-c%124cccc([nH]%124)-c%125cccc([nH]%125)-c%126cccc([nH]%126)-c%127cccc([nH]%127)-c%128cccc([nH]%128)-c%129cccc([nH]%129)-c%130cccc([nH]%130)-c%131cccc([nH]%131)-c%132cccc([nH]%132)-c%133cccc([nH]%133)-c%134cccc([nH]%134)-c%135cccc([nH]%135)-c%136cccc([nH]%136)-c%137cccc([nH]%137)-c%138cccc([nH]%138)-c%139cccc([nH]%139)-c%140cccc([nH]%140)-c%141cccc([nH]%141)-c%142cccc([nH]%142)-c%143cccc([nH]%143)-c%144cccc([nH]%144)-c%145cccc([nH]%145)-c%146cccc([nH]%146)-c%147cccc([nH]%147)-c%148cccc([nH]%148)-c%149cccc([nH]%149)-c%150cccc([nH]%150)-c%151cccc([nH]%151)-c%152cccc([nH]%152)-c%153cccc([nH]%153)-c%154cccc([nH]%154)-c%155cccc([nH]%155)-c%156cccc([nH]%156)-c%157cccc([nH]%157)-c%158cccc([nH]%158)-c%159cccc([nH]%159)-c%160cccc([nH]%160)-c%161cccc([nH]%161)-c%162cccc([nH]%162)-c%163cccc([nH]%163)-c%164cccc([nH]%164)-c%165cccc([nH]%165)-c%166cccc([nH]%166)-c%167cccc([nH]%167)-c%168cccc([nH]%168)-c%169cccc([nH]%169)-c%170cccc([nH]%170)-c%171cccc([nH]%171)-c%172cccc([nH]%172)-c%173cccc([nH]%173)-c%174cccc([nH]%174)-c%175cccc([nH]%175)-c%176cccc([nH]%176)-c%177cccc([nH]%177)-c%178cccc([nH]%178)-c%179cccc([nH]%179)-c%180cccc([nH]%180)-c%181cccc([nH]%181)-c%182cccc([nH]%182)-c%183cccc([nH]%183)-c%184cccc([nH]%184)-c%185cccc([nH]%185)-c%186cccc([nH]%186)-c%187cccc([nH]%187)-c%188cccc([nH]%188)-c%189cccc([nH]%189)-c%190cccc([nH]%190)-c%191cccc([nH]%191)-c%192cccc([nH]%192)-c%193cccc([nH]%193)-c%194cccc([nH]%194)-c%195cccc([nH]%195)-c%196cccc([nH]%196)-c%197cccc([nH]%197)-c%198cccc([nH]%198)-c%199cccc([nH]%199)-c%200cccc([nH]%200)-c%201cccc([nH]%201)-c%202cccc([nH]%202)-c%203cccc([nH]%203)-c%204cccc([nH]%204)-c%205cccc([nH]%205)-c%206cccc([nH]%206)-c%207cccc([nH]%207)-c%208cccc([nH]%208)-c%209cccc([nH]%209)-c%210cccc([nH]%210)-c%211cccc([nH]%211)-c%212cccc([nH]%212)-c%213cccc([nH]%213)-c%214cccc([nH]%214)-c%215cccc([nH]%215)-c%216cccc([nH]%216)-c%217cccc([nH]%217)-c%218cccc([nH]%218)-c%219cccc([nH]%219)-c%220cccc([nH]%220)-c%221cccc([nH]%221)-c%222cccc([nH]%222)-c%223cccc([nH]%223)-c%224cccc([nH]%224)-c%225cccc([nH]%225)-c%226cccc([nH]%226)-c%227cccc([nH]%227)-c%228cccc([nH]%228)-c%229cccc([nH]%229)-c%230cccc([nH]%230)-c%231cccc([nH]%231)-c%232cccc([nH]%232)-c%233cccc([nH]%233)-c%234cccc([nH]%234)-c%235cccc([nH]%235)-c%236cccc([nH]%236)-c%237cccc([nH]%237)-c%238cccc([nH]%238)-c%239cccc([nH]%239)-c%240cccc([nH]%240)-c%241cccc([nH]%241)-c%242cccc([nH]%242)-c%243cccc([nH]%243)-c%244cccc([nH]%244)-c%245cccc([nH]%245)-c%246cccc([nH]%246)-c%247cccc([nH]%247)-c%248cccc([nH]%248)-c%249cccc([nH]%249)-c%250cccc([nH]%250)-c%251cccc([nH]%251)-c%252cccc([nH]%252)-c%253cccc([nH]%253)-c%254cccc([nH]%254)-c%255cccc([nH]%255)-c%256cccc([nH]%256)-c%257cccc([nH]%257)-c%258cccc([nH]%258)-c%259cccc([nH]%259)-c%260cccc([nH]%260)-c%261cccc([nH]%261)-c%262cccc([nH]%262)-c%263cccc([nH]%263)-c%264cccc([nH]%264)-c%265cccc([nH]%265)-c%266cccc([nH]%266)-c%267cccc([nH]%267)-c%268cccc([nH]%268)-c%269cccc([nH]%269)-c%270cccc([nH]%270)-c%271cccc([nH]%271)-c%272cccc([nH]%272)-c%273cccc([nH]%273)-c%274cccc([nH]%274)-c%275cccc([nH]%275)-c%276cccc([nH]%276)-c%277cccc([nH]%277)-c%278cccc([nH]%278)-c%279cccc([nH]%279)-c%280cccc([nH]%280)-c%281cccc([nH]%281)-c%282cccc([nH]%282)-c%283cccc([nH]%283)-c%284cccc([nH]%284)-c%285cccc([nH]%285)-c%286cccc([nH]%286)-c%287cccc([nH]%287)-c%288cccc([nH]%288)-c%289cccc([nH]%289)-c%290cccc([nH]%290)-c%291cccc([nH]%291)-c%292cccc([nH]%292)-c%293cccc([nH]%293)-c%294cccc([nH]%294)-c%295cccc([nH]%295)-c%296cccc([nH]%296)-c%297cccc([nH]%297)-c%298cccc([nH]%298)-c%299cccc([nH]%299)-c%300cccc([nH]%300)-c%301cccc([nH]%301)-c%302cccc([nH]%302)-c%303cccc([nH]%303)-c%304cccc([nH]%304)-c%305cccc([nH]%305)-c%306cccc([nH]%306)-c%307cccc([nH]%307)-c%308cccc([nH]%308)-c%309cccc([nH]%309)-c%310cccc([nH]%310)-c%311cccc([nH]%311)-c%312cccc([nH]%312)-c%313cccc([nH]%313)-c%314cccc([nH]%314)-c%315cccc([nH]%315)-c%316cccc([nH]%316)-c%317cccc([nH]%317)-c%318cccc([nH]%318)-c%319cccc([nH]%319)-c%320cccc([nH]%320)-c%321cccc([nH]%321)-c%322cccc([nH]%322)-c%323cccc([nH]%323)-c%324cccc([nH]%324)-c%325cccc([nH]%325)-c%326cccc([nH]%326)-c%327cccc([nH]%327)-c%328cccc([nH]%328)-c%329cccc([nH]%329)-c%330cccc([nH]%330)-c%331cccc([nH]%331)-c%332cccc([nH]%332)-c%333cccc([nH]%333)-c%334cccc([nH]%334)-c%335cccc([nH]%335)-c%336cccc([nH]%336)-c%337cccc([nH]%337)-c%338